import{v as h,k as _,m as N,r as b,n as l,i as y,e as C,o as R,w as D,t as T,p as a,N as g,q as z,s as M}from"./index-5e2885e4.js";import{u as P}from"./use-table-operation-946f3f7c.js";import"./index.module-a00bcd5b.js";import{r as w,v,w as q}from"./index-2d941bf7.js";import{E as I}from"./EditOutlined-0243f050.js";import{P as U}from"./PlayCircleOutlined-e103aa1f.js";import{TaskModal as O}from"./task-modal-5fdd4b4a.js";import{_ as E}from"./lodash-11edae60.js";import{S as x}from"./SearchOutlined-2d664cde.js";import{N as d}from"./Space-d49acb7b.js";import{N as A}from"./Input-1bbd5e95.js";import{N as K}from"./Icon-b461a67a.js";import{N as B,a as G}from"./DataTable-bb49b036.js";import"./column-width-config-b963bc25.js";import"./DeleteOutlined-099c0ef1.js";import"./Popover-907f9950.js";import"./_baseMap-d2a29d52.js";import"./get-53588a31.js";import"./cssr-7767064c.js";import"./format-length-c9d165c6.js";import"./use-merged-state-d459d80e.js";import"./use-compitable-248ca92d.js";import"./next-frame-once-7035a838.js";import"./use-locale-ba0171d5.js";import"./Tooltip-5624ecb6.js";import"./Switch-bdda7b10.js";import"./service-d19f0ccd.js";import"./index-0bca5bb9.js";import"./Form-6e61837b.js";import"./FormItem-7f69a4d7.js";import"./RadioGroup-92bc79b0.js";import"./Suffix-9f9d022f.js";import"./Checkbox-2d4945a3.js";import"./Dropdown-8ccd025e.js";import"./create-bbda4d67.js";import"./Select-94feec49.js";import"./Empty-dd1b91e9.js";function J(){const{t:e}=h.useI18n(),n=_();N();const t=b({columns:[],tableData:[],page:l(1),pageSize:l(10),searchName:l(""),totalPage:l(1),showModalRef:l(!1),statusRef:l(0),row:{},loadingRef:l(!1)}),o={DATA_REPLICA:"whole_library_sync",DATA_INTEGRATION:"data_integration"},u=r=>{r.columns=[{title:e("project.synchronization_definition.synchronization_task_name"),key:"name"},{title:e("project.synchronization_definition.business_model"),key:"jobKey",render:i=>e(`project.synchronization_definition.${o[i.jobType]}`)},{title:e("project.synchronization_definition.task_describe"),key:"description"},{title:e("project.synchronization_definition.create_user"),key:"createUserName"},{title:e("project.synchronization_definition.create_time"),key:"createTime"},{title:e("project.synchronization_definition.update_user"),key:"updateUserName"},{title:e("project.synchronization_definition.update_time"),key:"updateTime"},P({title:e("project.synchronization_definition.operation"),key:"operation",buttons:[{text:e("project.synchronization_definition.edit"),onClick:i=>{n.push({path:`/task/synchronization-definition/${i.id}`})},icon:y(I)},{text:e("project.synchronization_definition.start"),onClick:i=>void c(i),icon:y(U)},{isDelete:!0,text:e("project.synchronization_definition.delete"),onPositiveClick:i=>void m(i),popTips:e("security.token.delete_confirm")}]})]},p=r=>{t.loadingRef||(t.loadingRef=!0,w(r).then(i=>{t.tableData=i.data,t.totalPage=i.totalPage,t.loadingRef=!1}).catch(()=>{t.loadingRef=!1}))},c=r=>{v(r.id).then(()=>{p({pageSize:t.pageSize,pageNo:t.page,searchName:t.searchName})})},m=r=>{t.tableData.length===1&&t.page>1&&--t.page,q({projectCode:r.projectCode,id:r.id}).then(()=>{p({pageSize:t.pageSize,pageNo:t.page,searchName:t.searchName})})};return{variables:t,createColumns:u,getTableData:p}}function V(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!M(e)}const Te=C({name:"SynchronizationDefinition",setup(){const{t:e}=h.useI18n(),n=N(),t=_(),{variables:o,createColumns:u,getTableData:p}=J();console.log("SynchronizationDefinition");const c=()=>{p({pageSize:o.pageSize,pageNo:o.page,searchName:o.searchName})},m=()=>{o.page=1,c()},r=()=>{o.showModalRef=!1},i=()=>{o.showModalRef=!1,c()},j=()=>{o.showModalRef=!0},f=()=>{o.page=1;const s={};o.searchName&&(s.searchName=o.searchName),t.replace({query:E.isEmpty(s)?{...n.query}:{...s,...n.query}}),c()},k=s=>{s.key==="Enter"&&f()},S=()=>{const{searchName:s}=n.query;s&&(o.searchName=s)};return R(()=>{S(),u(o),c()}),D(h.useI18n().locale,()=>{u(o)}),{t:e,...T(o),onUpdatePageSize:m,requestData:c,onCancelModal:r,onConfirmModal:i,handleModalChange:j,onSearch:f,handleKeyup:k}},render(){let e;return a(d,{vertical:!0},{default:()=>[a(g,null,{default:()=>[a(d,{justify:"space-between",itemStyle:{flexGrow:1}},{default:()=>[a(z,{type:"info",onClick:this.handleModalChange},V(e=this.t("project.synchronization_definition.create_synchronization_task"))?e:{default:()=>[e]}),a(d,{justify:"end"},{default:()=>[a(A,{clearable:!0,value:this.searchName,"onUpdate:value":n=>this.searchName=n,placeholder:this.t("project.synchronization_definition.task_name"),onKeyup:this.handleKeyup},null),a(z,{type:"primary",onClick:this.onSearch},{default:()=>[a(K,null,{default:()=>[a(x,null,null)]})]})]})]})]}),a(g,null,{default:()=>[a(d,{vertical:!0},{default:()=>[a(B,{loading:this.loadingRef,columns:this.columns,data:this.tableData},null),a(d,{justify:"center"},{default:()=>[a(G,{page:this.page,"onUpdate:page":n=>this.page=n,"page-size":this.pageSize,"onUpdate:page-size":n=>this.pageSize=n,"page-count":this.totalPage,"show-size-picker":!0,"page-sizes":[10,30,50],"show-quick-jumper":!0,onUpdatePage:this.requestData,onUpdatePageSize:this.onUpdatePageSize},null)]})]})]}),a(O,{showModalRef:this.showModalRef,onCancelModal:this.onCancelModal,onConfirmModal:this.onConfirmModal},null)]})}});export{Te as default};
