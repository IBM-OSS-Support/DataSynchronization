import{e as p,v as c,n,r as f,p as m}from"./index-5e2885e4.js";import{u as d,a as F,b as S,c as g,D as v}from"./use-form-structure-b872a9e7.js";import{e as b}from"./index-302b296b.js";import{N as w}from"./Form-6e61837b.js";import"./Grid-7fd51304.js";import"./Space-d49acb7b.js";import"./next-frame-once-7035a838.js";import"./FormItem-7f69a4d7.js";import"./format-length-c9d165c6.js";import"./get-53588a31.js";import"./Input-1bbd5e95.js";import"./use-locale-ba0171d5.js";import"./use-merged-state-d459d80e.js";import"./Suffix-9f9d022f.js";import"./Select-94feec49.js";import"./use-compitable-248ca92d.js";import"./cssr-7767064c.js";import"./Popover-907f9950.js";import"./_baseMap-d2a29d52.js";import"./create-bbda4d67.js";import"./Empty-dd1b91e9.js";import"./Checkbox-2d4945a3.js";import"./service-d19f0ccd.js";const Q=p({name:"StepTwoForm",setup(y,{expose:s}){const{t:l}=c.useI18n(),o=n(),r=f({rules:{},formStructure:[],locales:{},formName:"step-two-form",detailForm:{},config:[]});return s({validate:async()=>{await o.value.validate()},getFormItems:async(t,a)=>{if(!t||!a)return!1;const i=await b({pluginName:t,datasourceName:a});try{const e=JSON.parse(i);return r.locales=e.locales,Object.assign(r.detailForm,d(e.forms)),Object.assign(r.rules,F(e.forms,r.detailForm,l)),r.formStructure=S(e.apis?g(e.apis,e.forms):e.forms),r.formStructure=e.forms.map(u=>({...u,span:8})),!0}catch{return!1}},getValues:async()=>(await o.value.validate(),r.formStructure.map(t=>({label:t.label,key:t.field,value:r.detailForm[t.field]}))),setValues:t=>{Object.assign(r.detailForm,t)}}),()=>m(w,{rules:r.rules,ref:o,"require-mark-placement":"left",model:r.detailForm,labelWidth:100},{default:()=>[r.formStructure.length>0&&m(v,{model:r.detailForm,formStructure:r.formStructure,name:r.formName,locales:r.locales},null)]})}});export{Q as default};
