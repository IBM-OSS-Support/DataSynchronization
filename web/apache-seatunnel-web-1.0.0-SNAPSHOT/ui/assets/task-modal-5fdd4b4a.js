import{v as h,k as b,m as v,r as M,n as l,e as j,t as g,p as o,s as k}from"./index-5e2885e4.js";import{x as N}from"./index-2d941bf7.js";import{M as T}from"./index-0bca5bb9.js";import{N as R}from"./Form-6e61837b.js";import{N as m}from"./FormItem-7f69a4d7.js";import{N as p}from"./Input-1bbd5e95.js";import{N as z,a as u}from"./RadioGroup-92bc79b0.js";import{N as w}from"./Space-d49acb7b.js";import"./service-d19f0ccd.js";import"./format-length-c9d165c6.js";import"./get-53588a31.js";import"./use-locale-ba0171d5.js";import"./use-merged-state-d459d80e.js";import"./Suffix-9f9d022f.js";function I(t,i){const{t:d}=h.useI18n(),a=b();v();const e=M({taskModalFormRef:l(),saving:!1,model:{name:l(""),description:l(""),jobType:l("DATA_REPLICA")},rules:{name:{required:!0,trigger:["input","blur"],validator:(r,c)=>{if(!c)return Error(d("project.synchronization_definition.task_name_validate"))}},jobType:{required:!0,trigger:["change"]}}}),s=async()=>{if(await e.taskModalFormRef.validate(),!e.saving){e.saving=!0;try{await n(),e.saving=!1}catch{e.saving=!1}}},n=()=>{N({description:e.model.description,name:e.model.name,jobType:e.model.jobType}).then(r=>{e.model.description="",e.model.name="",i.emit("confirmModal",t.showModalRef),a.push({path:`/task/synchronization-definition/${r}`})})};return{variables:e,handleValidate:s}}function f(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!k(t)}const A={showModalRef:{type:Boolean,default:!1},row:{type:Object,default:{}}},$=j({name:"TaskModal",props:A,emits:["cancelModal","confirmModal"],setup(t,i){const{t:d}=h.useI18n(),{variables:a,handleValidate:e}=I(t,i),s=l(null),n=()=>{a.model.name="",a.model.description="",i.emit("cancelModal",t.showModalRef)},r=()=>{i.emit("cancelModal"),a.model.name="",a.model.description=""},c=()=>{e()},y=()=>{s.value&&s.value.validate(async _=>{_||(a.model.name="",a.model.description="")})};return{t:d,...g(a),cancelModal:n,confirmModal:c,preCancle:r,getNextStep:y,synchronizationForm:s}},render(){let t,i;const{t:d,getNextStep:a,showModalRef:e,preCancle:s}=this;return o("template",null,[o(T,{title:this.t("project.synchronization_definition.create_synchronization_task"),show:e,onCancel:this.cancelModal,onConfirm:this.confirmModal,confirmLoading:this.saving},{default:()=>[o(R,{model:this.model,rules:this.rules,ref:"taskModalFormRef"},{default:()=>[o(m,{label:this.t("project.synchronization_definition.synchronization_task_name"),path:"name"},{default:()=>[o(p,{clearable:!0,value:this.model.name,"onUpdate:value":n=>this.model.name=n,placeholder:this.t("project.synchronization_definition.task_name_tips")},null)]}),o(m,{label:this.t("project.synchronization_definition.task_describe"),path:"description"},{default:()=>[o(p,{clearable:!0,value:this.model.description,"onUpdate:value":n=>this.model.description=n,placeholder:this.t("project.synchronization_definition.task_describe_tips"),maxlength:50},null)]}),o(m,{label:this.t("project.synchronization_definition.business_model"),path:"businessModel"},{default:()=>[o(z,{value:this.model.jobType,"onUpdate:value":n=>this.model.jobType=n},{default:()=>[o(w,null,{default:()=>[o(u,{key:"wholeLibrarySync",value:"DATA_REPLICA"},f(t=this.t("project.synchronization_definition.whole_library_sync"))?t:{default:()=>[t]}),o(u,{key:"dataIntegration",value:"DATA_INTEGRATION"},f(i=this.t("project.synchronization_definition.data_integration"))?i:{default:()=>[i]})]})]})]})]})]})])}});export{$ as TaskModal};
